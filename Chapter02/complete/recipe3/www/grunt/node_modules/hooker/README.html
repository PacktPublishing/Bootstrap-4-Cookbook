<h1>JavaScript Hooker</h1><p>Monkey-patch (hook) functions for debugging and stuff.</p>
<h2>Getting Started</h2><p>This code should work just fine in Node.js:</p>
<p>First, install the module with: <code>npm install hooker</code></p>
<pre><code class="language-javascript">var hooker = require(&#39;hooker&#39;);
hooker.hook(Math, &quot;max&quot;, function() {
  console.log(arguments.length + &quot; arguments passed&quot;);
});
Math.max(5, 6, 7) // logs: &quot;3 arguments passed&quot;, returns 7
</code></pre>
<p>Or in the browser:</p>
<pre><code class="language-html">&lt;script src=&quot;dist/ba-hooker.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
hook(Math, &quot;max&quot;, function() {
  console.log(arguments.length + &quot; arguments passed&quot;);
});
Math.max(5, 6, 7) // logs: &quot;3 arguments passed&quot;, returns 7
&lt;/script&gt;
</code></pre>
<p>In the browser, you can attach Hooker&#39;s methods to any object.</p>
<pre><code class="language-html">&lt;script&gt;
this.exports = Bocoup.utils;
&lt;/script&gt;
&lt;script src=&quot;dist/ba-hooker.min.js&quot;&gt;&lt;/script&gt;
&lt;script&gt;
Bocoup.utils.hook(Math, &quot;max&quot;, function() {
  console.log(arguments.length + &quot; arguments passed&quot;);
});
Math.max(5, 6, 7) // logs: &quot;3 arguments passed&quot;, returns 7
&lt;/script&gt;
</code></pre>
<h2>Documentation</h2><h3>hooker.hook</h3><p>Monkey-patch (hook) one or more methods of an object.</p>
<h4>Signature:</h4><p><code>hooker.hook(object, [ props, ] [options | prehookFunction])</code></p>
<h4><code>props</code></h4><p>The optional <code>props</code> argument can be a method name, array of method names or null. If null (or omitted), all enumerable methods of <code>object</code> will be hooked.</p>
<h4><code>options</code></h4><ul>
<li><code>pre</code> - (Function) a pre-hook function to be executed before the original function. Arguments passed into the method will be passed into the pre-hook function as well.</li>
<li><code>post</code> - (Function) a post-hook function to be executed after the original function. The original function&#39;s result is passed into the post-hook function as its first argument, followed by the method arguments.</li>
<li><code>once</code> - (Boolean) if true, auto-unhook the function after the first execution.</li>
<li><code>passName</code> - (Boolean) if true, pass the name of the method into the pre-hook function as its first arg (preceding all other arguments), and into the post-hook function as the second arg (after result but preceding all other arguments).</li>
</ul>
<h4>Returns:</h4><p>An array of hooked method names.</p>
<h3>hooker.unhook</h3><p>Un-monkey-patch (unhook) one or more methods of an object.</p>
<h4>Signature:</h4><p><code>hooker.unhook(object [, props ])</code></p>
<h4><code>props</code></h4><p>The optional <code>props</code> argument can be a method name, array of method names or null. If null (or omitted), all methods of <code>object</code> will be unhooked.</p>
<h4>Returns:</h4><p>An array of unhooked method names.</p>
<h3>hooker.orig</h3><p>Get a reference to the original method from a hooked function.</p>
<h4>Signature:</h4><p><code>hooker.orig(object, props)</code></p>
<h3>hooker.override</h3><p>When a pre- or post-hook returns the result of this function, the value
passed will be used in place of the original function&#39;s return value. Any
post-hook override value will take precedence over a pre-hook override value.</p>
<h4>Signature:</h4><p><code>hooker.override(value)</code></p>
<h3>hooker.preempt</h3><p>When a pre-hook returns the result of this function, the value passed will
be used in place of the original function&#39;s return value, and the original
function will NOT be executed.</p>
<h4>Signature:</h4><p><code>hooker.preempt(value)</code></p>
<h3>hooker.filter</h3><p>When a pre-hook returns the result of this function, the context and
arguments passed will be applied into the original function.</p>
<h4>Signature:</h4><p><code>hooker.filter(context, arguments)</code></p>
<h2>Examples</h2><p>See the unit tests for more examples.</p>
<pre><code class="language-javascript">var hooker = require(&#39;hooker&#39;);
// Simple logging.
hooker.hook(Math, &quot;max&quot;, function() {
  console.log(arguments.length + &quot; arguments passed&quot;);
});
Math.max(5, 6, 7) // logs: &quot;3 arguments passed&quot;, returns 7

hooker.unhook(Math, &quot;max&quot;); // (This is assumed between all further examples)
Math.max(5, 6, 7) // 7

// Returning hooker.override(value) overrides the original value.
hooker.hook(Math, &quot;max&quot;, function() {
  if (arguments.length === 0) {
    return hooker.override(9000);
  }
});
Math.max(5, 6, 7) // 7
Math.max() // 9000

// Auto-unhook after one execution.
hooker.hook(Math, &quot;max&quot;, {
  once: true,
  pre: function() {
    console.log(&quot;Init something here&quot;);
  }
});
Math.max(5, 6, 7) // logs: &quot;Init something here&quot;, returns 7
Math.max(5, 6, 7) // 7

// Filter `this` and arguments through a pre-hook function.
hooker.hook(Math, &quot;max&quot;, {
  pre: function() {
    var args = [].map.call(arguments, function(num) {
      return num * 2;
    });
    return hooker.filter(this, args); // thisValue, arguments
  }
});
Math.max(5, 6, 7) // 14

// Modify the original function&#39;s result with a post-hook function.
hooker.hook(Math, &quot;max&quot;, {
  post: function(result) {
    return hooker.override(result * 100);
  }
});
Math.max(5, 6, 7) // 700

// Hook every Math method. Note: if Math&#39;s methods were enumerable, the second
// argument could be omitted. Since they aren&#39;t, an array of properties to hook
// must be explicitly passed. Non-method properties will be skipped.
// See a more generic example here: http://bit.ly/vvJlrS
hooker.hook(Math, Object.getOwnPropertyNames(Math), {
  passName: true,
  pre: function(name) {
    console.log(&quot;=&gt; Math.&quot; + name, [].slice.call(arguments, 1));
  },
  post: function(result, name) {
    console.log(&quot;&lt;= Math.&quot; + name, result);
  }
});

var result = Math.max(5, 6, 7);
// =&gt; Math.max [ 5, 6, 7 ]
// &lt;= Math.max 7
result // 7

result = Math.ceil(3.456);
// =&gt; Math.ceil [ 3.456 ]
// &lt;= Math.ceil 4
result // 4
</code></pre>
<h2>Contributing</h2><p>In lieu of a formal styleguide, take care to maintain the existing coding style. Add unit tests for any new or changed functionality. Lint and test your code using <a href="https://github.com/cowboy/grunt">grunt</a>.</p>
<p><em>Also, please don&#39;t edit files in the &quot;dist&quot; subdirectory as they are generated via grunt. You&#39;ll find source code in the &quot;lib&quot; subdirectory!</em></p>
<h2>Release History</h2><p>2012/01/09 - v0.2.3 - First official release.</p>
<h2>License</h2><p>Copyright (c) 2012 &quot;Cowboy&quot; Ben Alman<br>Licensed under the MIT license.<br><a href="http://benalman.com/about/license/">http://benalman.com/about/license/</a></p>
